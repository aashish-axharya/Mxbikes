@page "/inventory"

<h1>Inventory</h1>

<p>Inventory Details</p>

<nav class="navbar navbar-light bg-light justify-content-between">
	<button class="btn btn-primary" type="button" data-toggle="modal" data-target="#modalAddForm">
		<span class="oi oi-plus" /> Add Items
	</button>
</nav>
<table class="table">
	<thead>
		<tr>
			<th>Items</th>
			<th>Quantity</th>
			<th>Price</th>
		</tr>
	</thead>
	<tbody>
		@foreach (var items in _items)
		{
			<tr>
				<td>@items.ItemName</td>
				<td>@items.Quantity</td>
				<td>@items.Price</td>
			</tr>
		}
	</tbody>
</table>
@if (_showAddItem == true)
{
		<div class="modal fade" id="modalAddForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header text-center">
						<h4 class="modal-title w-100 font-weight-bold">Sign in</h4>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body mx-3">
						<div class="md-form mb-5">
							<i class="fas fa-envelope prefix grey-text"></i>
							<input type="text" class="form-control validate" @bind="_name" placeholder="Item Name">
						</div>
						<div class="md-form mb-4">
							<i class="fas fa-lock prefix grey-text"></i>
							<input type="text" class="form-control validate" @bind="_quantity" placeholder="Quantity">
						</div>
						<div class="md-form mb-4">
							<i class="fas fa-lock prefix grey-text"></i>
							<input type="text" class="form-control validate" @bind="_price" placeholder="Price">
						</div>
					</div>
					<div class="modal-footer d-flex justify-content-center">
						<button class="btn btn-primary" type="button" id="btnAdd" @onclick='()=> AddItem(true)' data-dismiss="modal">Add</button>
					</div>
				</div>
			</div>
		</div>
}

@code {
	[CascadingParameter]
	private GlobalState _globalState { get; set; }
	private List<Items> _items { get; set; }

	private bool _showAddItem { get; set; }
	private string _name { get; set; }
	private decimal _price { get; set; }
	private int _quantity{ get; set; }

	protected override void OnInitialized()
	{
		_items = InventoryService.GetAll(_globalState.CurrentUser.Id);
	}

	private void AddItem(bool value)
	{
		if (value == true)
		{
			_items = InventoryService.Create(_globalState.CurrentUser.Id, _name, _quantity);
			_name = "";
			_quantity = 0;
			_price = 0;
		}
	}
	private void AddItemHandler()
	{
		_showAddItem = true;

	}
}